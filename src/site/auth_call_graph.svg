<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="2050px" preserveAspectRatio="none" style="width:1359px;height:2050px;" version="1.1" viewBox="0 0 1359 2050" width="1359px" zoomAndPan="magnify"><defs><filter height="300%" id="fwvrt4gca7amz" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="221" x="564.75" y="22.9951">Autentication Filters Call Graph</text><rect fill="#FFFFFF" filter="url(#fwvrt4gca7amz)" height="1892.9063" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="203.5" y="99.7266"/><rect fill="#FFFFFF" filter="url(#fwvrt4gca7amz)" height="47.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="208.5" y="191.125"/><rect fill="#FFFFFF" filter="url(#fwvrt4gca7amz)" height="47.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="208.5" y="464.1875"/><rect fill="#FFFFFF" filter="url(#fwvrt4gca7amz)" height="148.5313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="208.5" y="682.8516"/><rect fill="#FFFFFF" filter="url(#fwvrt4gca7amz)" height="47.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="208.5" y="1583.0391"/><rect fill="#FFFFFF" filter="url(#fwvrt4gca7amz)" height="47.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="208.5" y="1896.5"/><rect fill="#FFFFFF" filter="url(#fwvrt4gca7amz)" height="233.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="542.5" y="611.5859"/><rect fill="#FFFFFF" filter="url(#fwvrt4gca7amz)" height="752.5234" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="542.5" y="898.6484"/><rect fill="#FFFFFF" filter="url(#fwvrt4gca7amz)" height="47.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="547.5" y="1160.7109"/><rect fill="#FFFFFF" filter="url(#fwvrt4gca7amz)" height="47.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="547.5" y="1462.7734"/><rect fill="#FFFFFF" filter="url(#fwvrt4gca7amz)" height="123.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="778.5" y="128.8594"/><rect fill="#FFFFFF" filter="url(#fwvrt4gca7amz)" height="138.5313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="778.5" y="386.7891"/><rect fill="#FFFFFF" filter="url(#fwvrt4gca7amz)" height="105.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="778.5" y="711.9844"/><rect fill="#FFFFFF" filter="url(#fwvrt4gca7amz)" height="138.5313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="778.5" y="1083.3125"/><rect fill="#FFFFFF" filter="url(#fwvrt4gca7amz)" height="138.5313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="778.5" y="1385.375"/><rect fill="#FFFFFF" filter="url(#fwvrt4gca7amz)" height="153.6641" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="778.5" y="1803.9688"/><rect fill="#FFFFFF" filter="url(#fwvrt4gca7amz)" height="62.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1027.5" y="741.1172"/><rect fill="#FFFFFF" filter="url(#fwvrt4gca7amz)" height="214.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1204.5" y="324.5234"/><rect fill="#FFFFFF" filter="url(#fwvrt4gca7amz)" height="199.6641" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1204.5" y="1036.1797"/><rect fill="#FFFFFF" filter="url(#fwvrt4gca7amz)" height="199.6641" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1204.5" y="1338.2422"/><rect fill="#FFFFFF" filter="url(#fwvrt4gca7amz)" height="260.1953" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1204.5" y="1711.4375"/><rect fill="#FFFFFF" filter="url(#fwvrt4gca7amz)" height="798.7891" style="stroke: #000000; stroke-width: 2.0;" width="1219" x="118.5" y="860.3828"/><rect fill="#FFFFFF" filter="url(#fwvrt4gca7amz)" height="288.0625" style="stroke: #000000; stroke-width: 2.0;" width="887.5" x="440" y="955.7813"/><rect fill="#FFFFFF" filter="url(#fwvrt4gca7amz)" height="288.0625" style="stroke: #000000; stroke-width: 2.0;" width="887.5" x="440" y="1257.8438"/><rect fill="#FFFFFF" filter="url(#fwvrt4gca7amz)" height="78.2656" style="stroke: #000000; stroke-width: 2.0;" width="526.5" x="128.5" y="1559.9063"/><rect fill="#FFFFFF" filter="url(#fwvrt4gca7amz)" height="306.4609" style="stroke: #000000; stroke-width: 2.0;" width="1200.5" x="128.5" y="1673.1719"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="33" x2="33" y1="68.5938" y2="2010.6328"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="208.5" x2="208.5" y1="68.5938" y2="2010.6328"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="547" x2="547" y1="68.5938" y2="2010.6328"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="783" x2="783" y1="68.5938" y2="2010.6328"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1032.5" x2="1032.5" y1="68.5938" y2="2010.6328"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1209.5" x2="1209.5" y1="68.5938" y2="2010.6328"/><rect fill="#FEFECE" filter="url(#fwvrt4gca7amz)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="47" x="8" y="33.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="33" x="15" y="53.292">Filter</text><rect fill="#FEFECE" filter="url(#fwvrt4gca7amz)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="47" x="8" y="2009.6328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="33" x="15" y="2029.6279">Filter</text><rect fill="#FEFECE" filter="url(#fwvrt4gca7amz)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="136" x="138.5" y="33.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="122" x="145.5" y="53.292">AbstractAuthFilter</text><rect fill="#FEFECE" filter="url(#fwvrt4gca7amz)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="136" x="138.5" y="2009.6328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="122" x="145.5" y="2029.6279">AbstractAuthFilter</text><rect fill="#FEFECE" filter="url(#fwvrt4gca7amz)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="191" x="450" y="33.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="177" x="457" y="53.292">AbstractSessionAuthFilter</text><rect fill="#FEFECE" filter="url(#fwvrt4gca7amz)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="191" x="450" y="2009.6328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="177" x="457" y="2029.6279">AbstractSessionAuthFilter</text><rect fill="#FEFECE" filter="url(#fwvrt4gca7amz)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="171" x="696" y="33.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="157" x="703" y="53.292">AbstractFormAuthFilter</text><rect fill="#FEFECE" filter="url(#fwvrt4gca7amz)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="171" x="696" y="2009.6328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="157" x="703" y="2029.6279">AbstractFormAuthFilter</text><rect fill="#FEFECE" filter="url(#fwvrt4gca7amz)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="114" x="973.5" y="33.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="100" x="980.5" y="53.292">FormAuthFilter</text><rect fill="#FEFECE" filter="url(#fwvrt4gca7amz)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="114" x="973.5" y="2009.6328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="100" x="980.5" y="2029.6279">FormAuthFilter</text><rect fill="#FEFECE" filter="url(#fwvrt4gca7amz)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="212" x="1101.5" y="33.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="198" x="1108.5" y="53.292">RememberMeFormAuthFilter</text><rect fill="#FEFECE" filter="url(#fwvrt4gca7amz)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="212" x="1101.5" y="2009.6328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="198" x="1108.5" y="2029.6279">RememberMeFormAuthFilter</text><rect fill="#FFFFFF" filter="url(#fwvrt4gca7amz)" height="1892.9063" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="203.5" y="99.7266"/><rect fill="#FFFFFF" filter="url(#fwvrt4gca7amz)" height="47.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="208.5" y="191.125"/><rect fill="#FFFFFF" filter="url(#fwvrt4gca7amz)" height="47.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="208.5" y="464.1875"/><rect fill="#FFFFFF" filter="url(#fwvrt4gca7amz)" height="148.5313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="208.5" y="682.8516"/><rect fill="#FFFFFF" filter="url(#fwvrt4gca7amz)" height="47.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="208.5" y="1583.0391"/><rect fill="#FFFFFF" filter="url(#fwvrt4gca7amz)" height="47.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="208.5" y="1896.5"/><rect fill="#FFFFFF" filter="url(#fwvrt4gca7amz)" height="233.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="542.5" y="611.5859"/><rect fill="#FFFFFF" filter="url(#fwvrt4gca7amz)" height="752.5234" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="542.5" y="898.6484"/><rect fill="#FFFFFF" filter="url(#fwvrt4gca7amz)" height="47.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="547.5" y="1160.7109"/><rect fill="#FFFFFF" filter="url(#fwvrt4gca7amz)" height="47.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="547.5" y="1462.7734"/><rect fill="#FFFFFF" filter="url(#fwvrt4gca7amz)" height="123.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="778.5" y="128.8594"/><rect fill="#FFFFFF" filter="url(#fwvrt4gca7amz)" height="138.5313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="778.5" y="386.7891"/><rect fill="#FFFFFF" filter="url(#fwvrt4gca7amz)" height="105.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="778.5" y="711.9844"/><rect fill="#FFFFFF" filter="url(#fwvrt4gca7amz)" height="138.5313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="778.5" y="1083.3125"/><rect fill="#FFFFFF" filter="url(#fwvrt4gca7amz)" height="138.5313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="778.5" y="1385.375"/><rect fill="#FFFFFF" filter="url(#fwvrt4gca7amz)" height="153.6641" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="778.5" y="1803.9688"/><rect fill="#FFFFFF" filter="url(#fwvrt4gca7amz)" height="62.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1027.5" y="741.1172"/><rect fill="#FFFFFF" filter="url(#fwvrt4gca7amz)" height="214.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1204.5" y="324.5234"/><rect fill="#FFFFFF" filter="url(#fwvrt4gca7amz)" height="199.6641" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1204.5" y="1036.1797"/><rect fill="#FFFFFF" filter="url(#fwvrt4gca7amz)" height="199.6641" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1204.5" y="1338.2422"/><rect fill="#FFFFFF" filter="url(#fwvrt4gca7amz)" height="260.1953" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1204.5" y="1711.4375"/><polygon fill="#A80036" points="191.5,95.7266,201.5,99.7266,191.5,103.7266,195.5,99.7266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="33.5" x2="197.5" y1="99.7266" y2="99.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="151" x="40.5" y="94.6606">doFilter(req,resp,chain)</text><polygon fill="#A80036" points="766.5,124.8594,776.5,128.8594,766.5,132.8594,770.5,128.8594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="213.5" x2="772.5" y1="128.8594" y2="128.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="96" x="220.5" y="123.7935">isProtectedURI</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="26" x="316.5" y="123.7935">(uri)</text><rect fill="#FBFB77" filter="url(#fwvrt4gca7amz)" height="23" style="stroke: #A80036; stroke-width: 1.0;" width="148" x="709" y="141.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="140" x="713" y="157.9263">never protect login uri</text><polygon fill="#A80036" points="229.5,187.125,219.5,191.125,229.5,195.125,225.5,191.125" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="223.5" x2="777.5" y1="191.125" y2="191.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="235.5" y="186.0591">[uri != login uri]</text><rect fill="#FBFB77" filter="url(#fwvrt4gca7amz)" height="23" style="stroke: #A80036; stroke-width: 1.0;" width="154" x="131" y="204.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="146" x="135" y="220.1919">check protection regex</text><polygon fill="#A80036" points="766.5,234.2578,776.5,238.2578,766.5,242.2578,770.5,238.2578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="213.5" x2="772.5" y1="238.2578" y2="238.2578"/><polygon fill="#A80036" points="224.5,248.2578,214.5,252.2578,224.5,256.2578,220.5,252.2578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="218.5" x2="782.5" y1="252.2578" y2="252.2578"/><rect fill="#EEEEEE" filter="url(#fwvrt4gca7amz)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1344.5" x="3" y="280.8242"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1347.5" y1="280.8242" y2="280.8242"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1347.5" y1="283.8242" y2="283.8242"/><rect fill="#EEEEEE" filter="url(#fwvrt4gca7amz)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="84" x="633.25" y="270.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="66" x="639.25" y="286.3247">Public URI</text><polygon fill="#A80036" points="1192.5,320.5234,1202.5,324.5234,1192.5,328.5234,1196.5,324.5234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="213.5" x2="1198.5" y1="324.5234" y2="324.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="142" x="220.5" y="319.4575">processPublicRequest</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="362.5" y="319.4575">(req, resp, chain)</text><rect fill="#FBFB77" filter="url(#fwvrt4gca7amz)" height="38" style="stroke: #A80036; stroke-width: 1.0;" width="147" x="1136" y="337.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="137" x="1140" y="353.5903">check remember_me</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="139" x="1140" y="368.7231">cookie if not logged in</text><polygon fill="#A80036" points="799.5,382.7891,789.5,386.7891,799.5,390.7891,795.5,386.7891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="793.5" x2="1203.5" y1="386.7891" y2="386.7891"/><rect fill="#FBFB77" filter="url(#fwvrt4gca7amz)" height="38" style="stroke: #A80036; stroke-width: 1.0;" width="177" x="695" y="399.7891"/><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="150" x="699" y="415.856">redirect logged in users</text><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="169" x="699" y="430.9888">from login URI to index URI</text><polygon fill="#A80036" points="229.5,460.1875,219.5,464.1875,229.5,468.1875,225.5,464.1875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="223.5" x2="777.5" y1="464.1875" y2="464.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="189" x="235.5" y="459.1216">[not logged or uri != login uri]</text><rect fill="#FBFB77" filter="url(#fwvrt4gca7amz)" height="23" style="stroke: #A80036; stroke-width: 1.0;" width="128" x="144" y="477.1875"/><text fill="#008000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="120" x="148" y="493.2544">process filter chain</text><polygon fill="#A80036" points="766.5,507.3203,776.5,511.3203,766.5,515.3203,770.5,511.3203" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="213.5" x2="772.5" y1="511.3203" y2="511.3203"/><polygon fill="#A80036" points="1192.5,521.3203,1202.5,525.3203,1192.5,529.3203,1196.5,525.3203" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="783.5" x2="1198.5" y1="525.3203" y2="525.3203"/><polygon fill="#A80036" points="224.5,535.3203,214.5,539.3203,224.5,543.3203,220.5,539.3203" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="218.5" x2="1208.5" y1="539.3203" y2="539.3203"/><rect fill="#EEEEEE" filter="url(#fwvrt4gca7amz)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1344.5" x="3" y="567.8867"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1347.5" y1="567.8867" y2="567.8867"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1347.5" y1="570.8867" y2="570.8867"/><rect fill="#EEEEEE" filter="url(#fwvrt4gca7amz)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="107" x="621.75" y="557.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="89" x="627.75" y="573.3872">Protected URI</text><polygon fill="#A80036" points="530.5,607.5859,540.5,611.5859,530.5,615.5859,534.5,611.5859" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="213.5" x2="536.5" y1="611.5859" y2="611.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="131" x="220.5" y="606.52">getAuthentifiedUser</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="31" x="351.5" y="606.52">(req)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="552.5" x2="594.5" y1="640.7188" y2="640.7188"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="594.5" x2="594.5" y1="640.7188" y2="653.7188"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="553.5" x2="594.5" y1="653.7188" y2="653.7188"/><polygon fill="#A80036" points="563.5,649.7188,553.5,653.7188,563.5,657.7188,559.5,653.7188" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="101" x="559.5" y="635.6528">getSessionUser</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="660.5" y="635.6528">(session)</text><polygon fill="#A80036" points="229.5,678.8516,219.5,682.8516,229.5,686.8516,225.5,682.8516" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="223.5" x2="541.5" y1="682.8516" y2="682.8516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="276" x="235.5" y="677.7856">[no user in session and uri == do_login uri]</text><polygon fill="#A80036" points="766.5,707.9844,776.5,711.9844,766.5,715.9844,770.5,711.9844" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="218.5" x2="772.5" y1="711.9844" y2="711.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="82" x="225.5" y="706.9185">authenticate</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="31" x="307.5" y="706.9185">(req)</text><polygon fill="#A80036" points="1015.5,737.1172,1025.5,741.1172,1015.5,745.1172,1019.5,741.1172" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="788.5" x2="1021.5" y1="741.1172" y2="741.1172"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="112" x="795.5" y="736.0513">checkCredentials</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="108" x="907.5" y="736.0513">(login, password)</text><rect fill="#FBFB77" filter="url(#fwvrt4gca7amz)" height="38" style="stroke: #A80036; stroke-width: 1.0;" width="119" x="973" y="754.1172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="977" y="770.1841">check credentails</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="75" x="977" y="785.3169">in database</text><polygon fill="#A80036" points="799.5,799.3828,789.5,803.3828,799.5,807.3828,795.5,803.3828" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="793.5" x2="1031.5" y1="803.3828" y2="803.3828"/><polygon fill="#A80036" points="229.5,813.3828,219.5,817.3828,229.5,821.3828,225.5,817.3828" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="223.5" x2="782.5" y1="817.3828" y2="817.3828"/><polygon fill="#A80036" points="530.5,827.3828,540.5,831.3828,530.5,835.3828,534.5,831.3828" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="213.5" x2="536.5" y1="831.3828" y2="831.3828"/><polygon fill="#A80036" points="224.5,841.3828,214.5,845.3828,224.5,849.3828,220.5,845.3828" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="218.5" x2="546.5" y1="845.3828" y2="845.3828"/><path d="M118.5,860.3828 L261.5,860.3828 L261.5,867.3828 L251.5,877.3828 L118.5,877.3828 L118.5,860.3828 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="798.7891" style="stroke: #000000; stroke-width: 2.0;" width="1219" x="118.5" y="860.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="98" x="133.5" y="873.4497">granted access</text><polygon fill="#A80036" points="530.5,894.6484,540.5,898.6484,530.5,902.6484,534.5,898.6484" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="213.5" x2="536.5" y1="898.6484" y2="898.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="165" x="220.5" y="893.5825">processProtectedRequest</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="145" x="385.5" y="893.5825">(user, req, resp, chain)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="552.5" x2="594.5" y1="927.7813" y2="927.7813"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="594.5" x2="594.5" y1="927.7813" y2="940.7813"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="553.5" x2="594.5" y1="940.7813" y2="940.7813"/><polygon fill="#A80036" points="563.5,936.7813,553.5,940.7813,563.5,944.7813,559.5,940.7813" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="118" x="559.5" y="922.7153">checkSessionUser</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="94" x="677.5" y="922.7153">(user, session)</text><path d="M440,955.7813 L549,955.7813 L549,962.7813 L539,972.7813 L440,972.7813 L440,955.7813 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="288.0625" style="stroke: #000000; stroke-width: 2.0;" width="887.5" x="440" y="955.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="64" x="455" y="968.8481">logging in</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="552.5" x2="594.5" y1="994.0469" y2="994.0469"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="594.5" x2="594.5" y1="994.0469" y2="1007.0469"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="553.5" x2="594.5" y1="1007.0469" y2="1007.0469"/><polygon fill="#A80036" points="563.5,1003.0469,553.5,1007.0469,563.5,1011.0469,559.5,1007.0469" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="100" x="559.5" y="988.981">setSessionUser</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="94" x="659.5" y="988.981">(user, session)</text><polygon fill="#A80036" points="1192.5,1032.1797,1202.5,1036.1797,1192.5,1040.1797,1196.5,1036.1797" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="552.5" x2="1198.5" y1="1036.1797" y2="1036.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="166" x="559.5" y="1031.1138">processPostLoginRequest</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="145" x="725.5" y="1031.1138">(user, req, resp, chain)</text><rect fill="#FBFB77" filter="url(#fwvrt4gca7amz)" height="23" style="stroke: #A80036; stroke-width: 1.0;" width="204" x="1107" y="1049.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="196" x="1111" y="1065.2466">handle remember_me request</text><polygon fill="#A80036" points="799.5,1079.3125,789.5,1083.3125,799.5,1087.3125,795.5,1083.3125" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="793.5" x2="1203.5" y1="1083.3125" y2="1083.3125"/><rect fill="#FBFB77" filter="url(#fwvrt4gca7amz)" height="38" style="stroke: #A80036; stroke-width: 1.0;" width="134" x="716" y="1096.3125"/><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="115" x="720" y="1112.3794">handle redirection</text><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="720" y="1127.5122">and saved requests</text><polygon fill="#A80036" points="568.5,1156.7109,558.5,1160.7109,568.5,1164.7109,564.5,1160.7109" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="562.5" x2="777.5" y1="1160.7109" y2="1160.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="574.5" y="1155.645">[not redirected]</text><rect fill="#FBFB77" filter="url(#fwvrt4gca7amz)" height="23" style="stroke: #A80036; stroke-width: 1.0;" width="53" x="521" y="1173.7109"/><text fill="#008000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="45" x="525" y="1189.7778">200 Ok</text><polygon fill="#A80036" points="766.5,1203.8438,776.5,1207.8438,766.5,1211.8438,770.5,1207.8438" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="552.5" x2="772.5" y1="1207.8438" y2="1207.8438"/><polygon fill="#A80036" points="1192.5,1217.8438,1202.5,1221.8438,1192.5,1225.8438,1196.5,1221.8438" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="783.5" x2="1198.5" y1="1221.8438" y2="1221.8438"/><polygon fill="#A80036" points="563.5,1231.8438,553.5,1235.8438,563.5,1239.8438,559.5,1235.8438" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="557.5" x2="1208.5" y1="1235.8438" y2="1235.8438"/><path d="M440,1257.8438 L558,1257.8438 L558,1264.8438 L548,1274.8438 L440,1274.8438 L440,1257.8438 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="288.0625" style="stroke: #000000; stroke-width: 2.0;" width="887.5" x="440" y="1257.8438"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="73" x="455" y="1270.9106">logging out</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="552.5" x2="594.5" y1="1296.1094" y2="1296.1094"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="594.5" x2="594.5" y1="1296.1094" y2="1309.1094"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="553.5" x2="594.5" y1="1309.1094" y2="1309.1094"/><polygon fill="#A80036" points="563.5,1305.1094,553.5,1309.1094,563.5,1313.1094,559.5,1309.1094" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="112" x="559.5" y="1291.0435">clearSessionUser</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="94" x="671.5" y="1291.0435">(user, session)</text><polygon fill="#A80036" points="1192.5,1334.2422,1202.5,1338.2422,1192.5,1342.2422,1196.5,1338.2422" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="552.5" x2="1198.5" y1="1338.2422" y2="1338.2422"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="175" x="559.5" y="1333.1763">processPostLogoutRequest</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="145" x="734.5" y="1333.1763">(user, req, resp, chain)</text><rect fill="#FBFB77" filter="url(#fwvrt4gca7amz)" height="23" style="stroke: #A80036; stroke-width: 1.0;" width="184" x="1117" y="1351.2422"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="176" x="1121" y="1367.3091">clear remember_me cookie</text><polygon fill="#A80036" points="799.5,1381.375,789.5,1385.375,799.5,1389.375,795.5,1385.375" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="793.5" x2="1203.5" y1="1385.375" y2="1385.375"/><rect fill="#FBFB77" filter="url(#fwvrt4gca7amz)" height="38" style="stroke: #A80036; stroke-width: 1.0;" width="123" x="722" y="1398.375"/><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="115" x="726" y="1414.4419">handle redirection</text><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="726" y="1429.5747">towards login uri</text><polygon fill="#A80036" points="568.5,1458.7734,558.5,1462.7734,568.5,1466.7734,564.5,1462.7734" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="562.5" x2="777.5" y1="1462.7734" y2="1462.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="574.5" y="1457.7075">[not redirected]</text><rect fill="#FBFB77" filter="url(#fwvrt4gca7amz)" height="23" style="stroke: #A80036; stroke-width: 1.0;" width="53" x="521" y="1475.7734"/><text fill="#008000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="45" x="525" y="1491.8403">200 Ok</text><polygon fill="#A80036" points="766.5,1505.9063,776.5,1509.9063,766.5,1513.9063,770.5,1509.9063" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="552.5" x2="772.5" y1="1509.9063" y2="1509.9063"/><polygon fill="#A80036" points="1192.5,1519.9063,1202.5,1523.9063,1192.5,1527.9063,1196.5,1523.9063" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="783.5" x2="1198.5" y1="1523.9063" y2="1523.9063"/><polygon fill="#A80036" points="563.5,1533.9063,553.5,1537.9063,563.5,1541.9063,559.5,1537.9063" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="557.5" x2="1208.5" y1="1537.9063" y2="1537.9063"/><path d="M128.5,1559.9063 L293.5,1559.9063 L293.5,1566.9063 L283.5,1576.9063 L128.5,1576.9063 L128.5,1559.9063 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="78.2656" style="stroke: #000000; stroke-width: 2.0;" width="526.5" x="128.5" y="1559.9063"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="120" x="143.5" y="1572.9731">normal processing</text><polygon fill="#A80036" points="229.5,1579.0391,219.5,1583.0391,229.5,1587.0391,225.5,1583.0391" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="223.5" x2="541.5" y1="1583.0391" y2="1583.0391"/><rect fill="#FBFB77" filter="url(#fwvrt4gca7amz)" height="23" style="stroke: #A80036; stroke-width: 1.0;" width="128" x="144" y="1596.0391"/><text fill="#008000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="120" x="148" y="1612.106">process filter chain</text><polygon fill="#A80036" points="530.5,1626.1719,540.5,1630.1719,530.5,1634.1719,534.5,1630.1719" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="213.5" x2="536.5" y1="1630.1719" y2="1630.1719"/><polygon fill="#A80036" points="224.5,1647.1719,214.5,1651.1719,224.5,1655.1719,220.5,1651.1719" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="218.5" x2="546.5" y1="1651.1719" y2="1651.1719"/><path d="M128.5,1673.1719 L283.5,1673.1719 L283.5,1680.1719 L273.5,1690.1719 L128.5,1690.1719 L128.5,1673.1719 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="306.4609" style="stroke: #000000; stroke-width: 2.0;" width="1200.5" x="128.5" y="1673.1719"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="110" x="143.5" y="1686.2388">forbidden access</text><polygon fill="#A80036" points="1192.5,1707.4375,1202.5,1711.4375,1192.5,1715.4375,1196.5,1711.4375" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="213.5" x2="1198.5" y1="1711.4375" y2="1711.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="167" x="220.5" y="1706.3716">processForbiddenRequest</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="387.5" y="1706.3716">(req, resp, chain)</text><rect fill="#FBFB77" filter="url(#fwvrt4gca7amz)" height="53" style="stroke: #A80036; stroke-width: 1.0;" width="220" x="1099" y="1724.4375"/><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="186" x="1103" y="1740.5044">check remember_me cookie,</text><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="115" x="1103" y="1755.6372">transfer control to</text><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="93" x="1222" y="1755.6372">ganted access</text><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="77" x="1103" y="1770.77">if successful</text><polygon fill="#A80036" points="799.5,1799.9688,789.5,1803.9688,799.5,1807.9688,795.5,1803.9688" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="793.5" x2="1203.5" y1="1803.9688" y2="1803.9688"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="83" x="805.5" y="1798.9028">[still no user]</text><rect fill="#FBFB77" filter="url(#fwvrt4gca7amz)" height="53" style="stroke: #A80036; stroke-width: 1.0;" width="123" x="722" y="1816.9688"/><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="115" x="726" y="1833.0356">handle redirection</text><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="84" x="726" y="1848.1685">towards login</text><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="726" y="1863.3013">and save request</text><polygon fill="#A80036" points="229.5,1892.5,219.5,1896.5,229.5,1900.5,225.5,1896.5" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="223.5" x2="777.5" y1="1896.5" y2="1896.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="235.5" y="1891.4341">[not redirected]</text><rect fill="#FBFB77" filter="url(#fwvrt4gca7amz)" height="23" style="stroke: #A80036; stroke-width: 1.0;" width="99" x="159" y="1909.5"/><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="91" x="163" y="1925.5669">403 Forbidden</text><polygon fill="#A80036" points="766.5,1939.6328,776.5,1943.6328,766.5,1947.6328,770.5,1943.6328" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="213.5" x2="772.5" y1="1943.6328" y2="1943.6328"/><polygon fill="#A80036" points="1192.5,1953.6328,1202.5,1957.6328,1192.5,1961.6328,1196.5,1957.6328" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="783.5" x2="1198.5" y1="1957.6328" y2="1957.6328"/><polygon fill="#A80036" points="224.5,1967.6328,214.5,1971.6328,224.5,1975.6328,220.5,1971.6328" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="218.5" x2="1208.5" y1="1971.6328" y2="1971.6328"/><polygon fill="#A80036" points="44.5,1988.6328,34.5,1992.6328,44.5,1996.6328,40.5,1992.6328" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="38.5" x2="207.5" y1="1992.6328" y2="1992.6328"/><!--
@startuml
skinparam backgroundColor white
title
	Autentication Filters Call Graph
end title

participant Filter
participant AbstractAuthFilter
participant AbstractSessionAuthFilter
participant AbstractFormAuthFilter
participant FormAuthFilter
participant RememberMeFormAuthFilter

Filter -> AbstractAuthFilter ++ : <b>doFilter(req,resp,chain)</b>

  AbstractAuthFilter -> AbstractFormAuthFilter : <b>isProtectedURI</b>(uri)
    activate AbstractFormAuthFilter
    rnote over AbstractFormAuthFilter : never protect login uri
    AbstractAuthFilter <- AbstractFormAuthFilter ++ : [uri != login uri]
      rnote over AbstractAuthFilter : check protection regex
    return
  return

  == Public URI ==

  AbstractAuthFilter -> RememberMeFormAuthFilter ++ : <b>processPublicRequest</b>(req, resp, chain)
    rnote over RememberMeFormAuthFilter : check remember_me\ncookie if not logged in
    RememberMeFormAuthFilter -> AbstractFormAuthFilter ++
      rnote over AbstractFormAuthFilter : <font color="blue">redirect logged in users</font>\n<font color="blue">from login URI to index URI</font>
      AbstractFormAuthFilter -> AbstractAuthFilter ++ : [not logged or uri != login uri]
        rnote over AbstractAuthFilter : <font color="green">process filter chain</font>
      return
    return
  return

== Protected URI ==

  AbstractAuthFilter -> AbstractSessionAuthFilter ++ : <b>getAuthentifiedUser</b>(req)
    AbstractSessionAuthFilter -> AbstractSessionAuthFilter : <b>getSessionUser</b>(session)
    AbstractSessionAuthFilter -> AbstractAuthFilter ++ : [no user in session and uri == do_login uri]
      AbstractAuthFilter -> AbstractFormAuthFilter ++ : <b>authenticate</b>(req)
        AbstractFormAuthFilter -> FormAuthFilter ++ : <b>checkCredentials</b>(login, password)
          rnote over FormAuthFilter : check credentails\nin database
        return
      return
    return
  return  

  group granted access
    AbstractAuthFilter -> AbstractSessionAuthFilter ++ : <b>processProtectedRequest</b>(user, req, resp, chain)
      AbstractSessionAuthFilter -> AbstractSessionAuthFilter : <b>checkSessionUser</b>(user, session)
      group logging in
        AbstractSessionAuthFilter -> AbstractSessionAuthFilter : <b>setSessionUser</b>(user, session)
        AbstractSessionAuthFilter -> RememberMeFormAuthFilter ++ : <b>processPostLoginRequest</b>(user, req, resp, chain)
          rnote over RememberMeFormAuthFilter : handle remember_me request
          AbstractFormAuthFilter <- RememberMeFormAuthFilter ++
            rnote over AbstractFormAuthFilter : <font color="blue">handle redirection</font>\n<font color="blue">and saved requests</font>
            AbstractFormAuthFilter -> AbstractSessionAuthFilter ++ : [not redirected]
              rnote over AbstractSessionAuthFilter : <font color="green">200 Ok</font>
            return
          return
        return
      end
      group logging out
        AbstractSessionAuthFilter -> AbstractSessionAuthFilter : <b>clearSessionUser</b>(user, session)
        AbstractSessionAuthFilter -> RememberMeFormAuthFilter ++ : <b>processPostLogoutRequest</b>(user, req, resp, chain)
          rnote over RememberMeFormAuthFilter : clear remember_me cookie
          AbstractFormAuthFilter <- RememberMeFormAuthFilter ++
            rnote over AbstractFormAuthFilter : <font color="blue">handle redirection</font>\n<font color="blue">towards login uri</font>
            AbstractSessionAuthFilter <- AbstractFormAuthFilter ++ : [not redirected]
              rnote over AbstractSessionAuthFilter : <font color="green">200 Ok</font>
            return
          return    
        return
      end
      group normal processing
        AbstractAuthFilter <- AbstractSessionAuthFilter ++
          rnote over AbstractAuthFilter : <font color="green">process filter chain</font>
        return
      end
    return
  end

  group forbidden access
    AbstractAuthFilter -> RememberMeFormAuthFilter ++ : <b>processForbiddenRequest</b>(req, resp, chain)
      rnote over RememberMeFormAuthFilter : <font color="blue">check remember_me cookie,</font>\n<font color="blue">transfer control to <b>ganted access</b></font>\n<font color="blue">if successful</font>
      AbstractFormAuthFilter <- RememberMeFormAuthFilter ++ : [still no user]
        rnote over AbstractFormAuthFilter : <font color="blue">handle redirection</font>\n<font color="blue">towards login</font>\n<font color="blue">and save request</font>
        AbstractAuthFilter <- AbstractFormAuthFilter ++ : [not redirected]
          rnote over AbstractAuthFilter : <font color="red">403 Forbidden</font>
        return
      return
    return
  end

return

@enduml

PlantUML version 1.2019.04(Fri Mar 29 16:44:36 CET 2019)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_202-release-1483-b39
Operating System: Linux
OS Version: 4.18.0-18-generic
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>